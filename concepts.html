<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MANGO: Core Concepts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('concepts.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Core Concepts </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md14"></a>
Worker Groups and MPI Partitions</h1>
<p>Given a set of \(M\) MPI processes, an optimization problem can be parallelized in different ways. At one extreme, all \(M\) processes could work together on each evaluation of the objective function, with the optimization algorithm itself only initiating a single evaluation of the objective function \(f\) at a time. At the other extreme, the optimization algorithm could request \(M\) evaluations of \(f\) all at once, with each evaluation performed by a single processor. This type of parallelization can be useful for instance when finite differences are used to evaluate gradients. Or, both types of parallelization could be used at the same time. To allow all of these types of parallelization, MANGO uses the concepts of <em>worker groups</em> and <em>MPI partitions</em>.</p>
<p>A <em>worker group</em> is a set of MPI processes that works together to evaluate the objective function. An MPI partition is a division of the total set of \(M\) MPI processors into one or more worker groups. If there are \(W\) worker groups, each group has approximately \(M / W \) processors (approximate because one must round up or down.) MANGO has a class <a class="el" href="classmango_1_1MPI__Partition.html" title="A class for dividing the set of MPI processes into worker groups.">mango::MPI_Partition</a> to manage this division of processors into worker groups. Each MANGO optimization problem, represented by an instance of the <a class="el" href="classmango_1_1Problem.html">mango::Problem</a> class, has an instance of <a class="el" href="classmango_1_1MPI__Partition.html" title="A class for dividing the set of MPI processes into worker groups.">mango::MPI_Partition</a> as a member. The number of worker groups can be set by calling <a class="el" href="classmango_1_1MPI__Partition.html#ae458085adce912463e718c56b9909660" title="Set the number of worker groups to the given integer.">mango::MPI_Partition::set_N_worker_groups()</a> or by reading a value in from a file via <a class="el" href="classmango_1_1Problem.html#af9f6439b8b2134ec1461f35746092a72" title="Reads in the number of worker groups and algorithm from a file.">mango::Problem::read_input_file()</a>.</p>
<p>Some optimization algorithms, such as Nelder-Mead, do not support concurrent evaluations of \( f \). In this case, the number of worker groups should be \( W=1 \). MANGO will automatically set \( W = 1\) for any such algorithm. Any algorithm that uses derivatives, such as BFGS, can take advantage of multiple worker groups to evaluate derivatives by finite differences. If the number of parameters (i.e. independent variables) is \( N \), you ideally want to set \( W = N+1 \) when using 1-sided finite differences, and set \( W = 2 N + 1 \) when using centered differences. These ideal values are not required however - MANGO will evaluate finite difference derivatives for any value of \( W \), and results should be exactly independent of \( W \). Other derivative-free algorithms that intrinsically support parallelization, such as HOPSPACK, can use any number of worker groups, not tied to the number of parameters.</p>
<p>An MPI partition is associated with three MPI communicators, "world", "worker_groups", and "group_leaders". The "world" communicator represents all \( M \) MPI processors available to MANGO. (Normally this communicator is the same as <code>MPI_COMM_WORLD</code>, but it could be a subset thereof if you wish.) The "worker_groups" communicator also contains the same \( M \) processors, but grouped into colors, with a different color representing each worker group. Therefore subroutines such as <code>MPI_Send</code> and <code>MPI_Bcast</code> on this communicator exchange data only within one worker group. This "worker_groups" communicator is therefore the one that must be used for evaluation of the objective function. Finally, the "group_leaders" communicator only includes the \( W \) processors that have rank 0 in the "worker_groups" communicator. This communicator is used for communicating data within a parallel optimization <em>algorithm</em> (as opposed to within a parallelized objective function). Each of the three MPI communicators has "get" methods in <a class="el" href="classmango_1_1MPI__Partition.html" title="A class for dividing the set of MPI processes into worker groups.">mango::MPI_Partition</a> to determine the number of processors, each processor's rank, and whether a given processor has rank 0.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
General vs least-squares problems</h1>
<p>A general optimization problem has the form </p><p class="formulaDsp">
\[ \min_{\vec{x}} f(\vec{x}), \]
</p>
<p> possibly with constraints. The vector \( \vec{x} \) has a dimension that is called <code>N_parameters</code> in MANGO.</p>
<p>A "least-squares problem" is one in which the objective function has the form </p><p class="formulaDsp">
\[ f(\vec{x}) = \sum_{j=1}^{N_t} \left( \frac{R_j(\vec{x}) - T_j}{\sigma_j}\right)^2. \]
</p>
<p> MANGO supports both general and least-squares problems. General problems are represented by the class <a class="el" href="classmango_1_1Problem.html">mango::Problem</a>, while least-squares problems are represeted by the subclass <a class="el" href="classmango_1_1Least__squares__problem.html">mango::Least_squares_problem</a>. In the latter, \(N_t \) is called <code>N_terms</code>, and \( T_j \) and \( \sigma_j \) are supplied as the arrays <code>targets</code> and <code>sigmas</code> to the constructor. In a least-squares problem, you supply a subroutine to compute the "residuals" \( R_j \) rather than \( f \) itself.</p>
<p>Any optimization algorithm for general problems can be applied to least-squares problems. However some algorithms (such as Levenberg-Marquardt) are specific to least-squares problems, and cannot be applied to general problems. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
