<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MANGO: Output files and plotting</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('plotting.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Output files and plotting </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md34"></a>
Convergence history</h1>
<p>When an optimization is carried out with MANGO, an output file is created which records the history of the objective function evaluations. Usually this file is named <code>mango_out.&lt;something&gt;</code>, but any name you like can be set using <a class="el" href="classmango_1_1Problem.html#a67cf70869bebfa82d20f41af9354025c" title="Sets the name of the output file that will record values of the objective function at each evaluation...">mango::Problem::set_output_filename</a>. The first 5 lines of this file are header lines, with lines 1, 3, and 5 just a description of what follows. Line 2 is either <code>standard</code> or <code>least_squares</code>, depending on whether the optimization problem has least-squares form. Line 4 gives <code>N_parameters</code>, the dimension of the search space. In the main data section that begins on line 6, the following data are recorded. The objective function evaluation count, the time in seconds since the optimization began, the values of the independent variables, and the value of the objective function. For least-squares problems, additional columns may be included that give the value of each residual term in the objective function. These additional columns can be included or excluded using <a class="el" href="classmango_1_1Least__squares__problem.html#ad58139fe5bda38d223580bc61bbd98dd" title="Determine whether or not to print each individual residual in the MANGO output file.">mango::Least_squares_problem::set_print_residuals_in_output_file</a>.</p>
<p>If the optimization completes gracefully, a final row will be appended to the output file, which is a copy of the previous line corresponding to the minimum objective function.</p>
<p>The data in the output file can be plotted using the python script <code>plotting/mangoPlot</code>. This script requires <code>numpy</code> and <code>matplotlib</code>. As command-line arguments to this script, you can supply the names of one or more MANGO output files. The wildcard character <code>*</code> can be used to select multiple files, just as for commands like <code>ls</code>. The <code>mangoPlot</code> script will display two plots. In both figures, the vertical axis is the objective function minus the minimum value of the objective function found among all the output files being plotted. In the top figure, the horizontal axis is the number of evaluations of the objective function. In the second figure, the horizontal axis is the wallclock time in seconds.</p>
<p>The <code>mangoPlot</code> script is useful for comparing the performance of different optimization algorithms. For example, here is typical output of <code>mangoPlot</code>, comparing 3 PETSc algorithms for the <code>chwirut_c</code> example, each using 5 MPI processors and 5 worker groups:</p>
<div class="image">
<img src="mangoPlot.png" alt="" width="100%"/>
</div>
<h1><a class="anchor" id="autotoc_md35"></a>
Levenberg-Marquardt history</h1>
<p>When MANGO's native Levenberg-Marquardt algorithm is used, an additional output file is saved containing details of the algorithm's history. The file has the same name as MANGO's main output file described in the previous section, but with <code>_levenberg_marquardt</code> appended. The first row is a header line that labels the columns. Each row thereafter indicates one step in the Levenberg-Marquardt iterations. In this main data, the first column indicates the main (i.e. outer) iteration. The next column, <code>j_line_search</code> indicates the inner iteration, in which the objective function is evaluated in parallel for a batch of values of \(\lambda\). The next <code>N_line_search</code> columns give the values of \(\lambda\) used for these concurrent evaluations. Next come <code>N_line_search</code> columns with the corresponding values of the objective function. The penultimate column gives the 0-based index among these <code>N_line_search</code> values for which the objective function is lowest. The final column is a 0 or 1, indicating whether any of the evaluations in this row successfully reduced the objective function compared to the previous outer iteration.</p>
<p>If the algorithm is working well, the last column should be mostly 1, except at the last outer iteration when the iteration reaches the optimum. Values of 1 mean the range of \(\lambda\) is appropriate, such that the objective function is reduced in the first set of concurrent function evaluations, and further rounds of objective function evaluations are not needed.</p>
<p>The data in one of these Levenberg-Marquardt history files can be plotted with the python script <code>plotting/LevenbergMarquardtPlot</code>. This script requires <code>numpy</code> and <code>matplotlib</code>. The script requires one command-line argument, the name of the <code>_levenberg_marquardt</code> file. Here is an example of typical output, showing a case with <code>N_line_search=8</code> (corresponding here to the number of worker groups):</p>
<div class="image">
<img src="LevenbergMarquardtPlot.png" alt="" width="100%"/>
</div>
<p>The vertical coordinate is \(\lambda\). Each colored circle represents an evaluation of the objective function, and each column of circles reprents an outer iteration. Colors indicate the inner iteration index <code>j_line_search</code>. In each column, the red batch of points are evaluated concurrently, then the yellow batch of points are evaluated concurrently, etc. The black curve connects the function evaluations with lowest value of the objective function, i.e. the evaluations that were used as the basis for the next outer iteration. Overall, the figure shows how \(\lambda\) evolves during the optimization, and the range of values of \(\lambda\) that are sampled. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
